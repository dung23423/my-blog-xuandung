


  





<!doctype html>
<html
  lang="vi"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="light"
  data-auto-appearance="true"
><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#FFFFFF" />
  
  <title>JavaScript Closures: Từ &#39;Hả?&#39; đến &#39;À ra thế!&#39; - Bí mật về phạm vi biến &middot; Blog của Triệu Xuân Dũng</title>
    <meta name="title" content="JavaScript Closures: Từ &#39;Hả?&#39; đến &#39;À ra thế!&#39; - Bí mật về phạm vi biến &middot; Blog của Triệu Xuân Dũng" />
  
  
  
  
  
  <script
    type="text/javascript"
    src="http://localhost:1313/js/appearance.min.8a082f81b27f3cb2ee528df0b0bdc39787034cf2cc34d4669fbc9977c929023c.js"
    integrity="sha256-iggvgbJ/PLLuUo3wsL3Dl4cDTPLMNNRmn7yZd8kpAjw="
  ></script>
  
  
    
  
  
  
  
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="http://localhost:1313/css/main.bundle.min.c3d236fb27d5333aa172b376a62368b07beeeaeffdb574761ff290f6d5809002.css"
    integrity="sha256-w9I2&#43;yfVMzqhcrN2piNosHvu6u/9tXR2H/KQ9tWAkAI="
  />
  
  
  
  
  
  
  
  <meta
    name="description"
    content="
      Closure là gì? Tại sao quan trọng? Từ bug counter không hoạt động đến hiểu sâu về phạm vi biến, ngữ cảnh thực thi và các mẫu thiết kế với closure.
    "
  />
  
  
  
  
    <link rel="canonical" href="http://localhost:1313/posts/javascript-closures-scope/" />
  
  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="http://localhost:1313/posts/javascript-closures-scope/">
  <meta property="og:site_name" content="Blog của Triệu Xuân Dũng">
  <meta property="og:title" content="JavaScript Closures: Từ &#39;Hả?&#39; đến &#39;À ra thế!&#39; - Bí mật về phạm vi biến">
  <meta property="og:description" content="Closure là gì? Tại sao quan trọng? Từ bug counter không hoạt động đến hiểu sâu về phạm vi biến, ngữ cảnh thực thi và các mẫu thiết kế với closure.">
  <meta property="og:locale" content="vi">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-10-14T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-10-14T00:00:00+00:00">
    <meta property="article:tag" content="JavaScript">
    <meta property="article:tag" content="Closures">
    <meta property="article:tag" content="Scope">
    <meta property="article:tag" content="Nâng Cao">
    <meta property="article:tag" content="Cơ Bản">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="JavaScript Closures: Từ &#39;Hả?&#39; đến &#39;À ra thế!&#39; - Bí mật về phạm vi biến">
  <meta name="twitter:description" content="Closure là gì? Tại sao quan trọng? Từ bug counter không hoạt động đến hiểu sâu về phạm vi biến, ngữ cảnh thực thi và các mẫu thiết kế với closure.">

  
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "JavaScript Closures: Từ \u0027Hả?\u0027 đến \u0027À ra thế!\u0027 - Bí mật về phạm vi biến",
    "headline": "JavaScript Closures: Từ \u0027Hả?\u0027 đến \u0027À ra thế!\u0027 - Bí mật về phạm vi biến",
    "description": "Closure là gì? Tại sao quan trọng? Từ bug counter không hoạt động đến hiểu sâu về phạm vi biến, ngữ cảnh thực thi và các mẫu thiết kế với closure.",
    "abstract": "Tôi code JavaScript 6 tháng mới biết closures tồn tại. Thêm 3 tháng nữa mới thực sự hiểu nó. Đây là con đường ngắn hơn để bạn hiểu.",
    "inLanguage": "vi",
    "url" : "http:\/\/localhost:1313\/posts\/javascript-closures-scope\/",
    "author" : {
      "@type": "Person",
      "name": "Triệu Xuân Dũng"
    },
    "copyrightYear": "2025",
    "dateCreated": "2025-10-14T00:00:00\u002b00:00",
    "datePublished": "2025-10-14T00:00:00\u002b00:00",
    
    "dateModified": "2025-10-14T00:00:00\u002b00:00",
    
    "keywords": ["JavaScript","Closures","Scope","Nâng cao","Cơ bản"],
    
    "mainEntityOfPage": "true",
    "wordCount": "2615"
  }
  </script>
    
    <script type="application/ld+json">
    {
   "@context": "https://schema.org",
   "@type": "BreadcrumbList",
   "itemListElement": [
     {
       "@type": "ListItem",
       "item": "http://localhost:1313/",
       "name": "Trang Chủ",
       "position": 1
     },
     {
       "@type": "ListItem",
       "item": "http://localhost:1313/posts/",
       "name": "Posts",
       "position": 2
     },
     {
       "@type": "ListItem",
       "item": "http://localhost:1313/categories/javascript/",
       "name": "JavaScript",
       "position": 3
     },
     {
       "@type": "ListItem",
       "name": "Java Script Closures Từ ' Hả?' Đến ' À Ra Thế!' Bí Mật Về Phạm Vi Biến",
       "position": 4
     }
   ]
 }
  </script>

  
  
    <meta name="author" content="Triệu Xuân Dũng" />
  
  
    
      <link href="https://mastodon.social/@yourusername" rel="me" />
    
      <link href="https://github.com/yourusername" rel="me" />
    
      <link href="https://linkedin.com/in/yourprofile" rel="me" />
    
      <link href="https://facebook.com/yourprofile" rel="me" />
    
      <link href="https://twitter.com/yourusername" rel="me" />
    
      <link href="mailto:your@email.com" rel="me" />
    
  
  
  







  
  

  
  
    
<style>
 
@media (max-width: 768px) {
    .mobile-menu-wrapper {
        position: fixed;
        top: 1rem;
        left: 0;
        right: 0;
        z-index: 2000;
        display: flex;
        justify-content: space-between;
        padding: 0 1rem;
        pointer-events: none;
    }
    
    .mobile-menu-wrapper > * {
        pointer-events: auto;
    }
    
    .mobile-nav-btn,
    .mobile-search-btn {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        border: none;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        transition: all 0.3s ease;
    }
    
    .mobile-nav-btn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        flex-direction: column;
        gap: 4px;
    }
    
    .mobile-nav-btn span {
        width: 20px;
        height: 2px;
        background: white;
        border-radius: 2px;
        transition: all 0.3s ease;
    }
    
    .mobile-nav-btn.active span:nth-child(1) {
        transform: rotate(45deg) translate(5px, 5px);
    }
    
    .mobile-nav-btn.active span:nth-child(2) {
        opacity: 0;
    }
    
    .mobile-nav-btn.active span:nth-child(3) {
        transform: rotate(-45deg) translate(6px, -6px);
    }
    
    .mobile-search-btn {
        background: white;
        border: 2px solid #667eea;
    }
    
    .mobile-search-btn svg {
        width: 24px;
        height: 24px;
        color: #667eea;
    }
    
     
    .mobile-sidebar {
        position: fixed;
        top: 0;
        left: -280px;
        width: 280px;
        height: 100vh;
        background: white;
        z-index: 1999;
        transition: left 0.3s ease;
        box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        overflow-y: auto;
        padding-top: 5rem;
    }
    
    .mobile-sidebar.active {
        left: 0;
    }
    
    .mobile-sidebar a {
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem 1.5rem;
        color: #374151;
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s ease;
        border-left: 3px solid transparent;
    }
    
    .mobile-sidebar a:hover {
        background: rgba(102, 126, 234, 0.1);
        border-left-color: #667eea;
        color: #667eea;
    }
    
    .mobile-sidebar svg {
        width: 20px;
        height: 20px;
    }
    
     
    .mobile-search-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0,0,0,0.8);
        backdrop-filter: blur(5px);
        z-index: 2001;
        display: none;
        align-items: flex-start;
        justify-content: center;
        padding: 2rem;
        padding-top: 5rem;
    }
    
    .mobile-search-overlay.active {
        display: flex;
    }
    
    .search-box {
        background: white;
        border-radius: 16px;
        width: 100%;
        max-width: 500px;
        padding: 2rem;
        position: relative;
    }
    
    .search-box input {
        width: 100%;
        padding: 1rem;
        border: 2px solid #667eea;
        border-radius: 12px;
        font-size: 1rem;
    }
    
    .search-close {
        position: absolute;
        top: 1rem;
        right: 1rem;
        background: none;
        border: none;
        font-size: 2rem;
        color: #9ca3af;
        cursor: pointer;
    }
    
     
    .mobile-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0,0,0,0.5);
        z-index: 1998;
        display: none;
    }
    
    .mobile-overlay.active {
        display: block;
    }
    
     
    .dark .mobile-sidebar,
    .dark .search-box {
        background: #1f2937;
    }
    
    .dark .mobile-sidebar a {
        color: #d1d5db;
    }
    
    .dark .search-box input {
        background: #111827;
        color: white;
    }
}

@media (min-width: 769px) {
    .mobile-menu-wrapper,
    .mobile-sidebar,
    .mobile-search-overlay,
    .mobile-overlay {
        display: none !important;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    
    if (window.innerWidth > 768) return;
    
    
    const menuHTML = `
        <div class="mobile-menu-wrapper">
            <button class="mobile-nav-btn" id="mobileNavBtn">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <button class="mobile-search-btn" id="mobileSearchBtn">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                </svg>
            </button>
        </div>
        
        <div class="mobile-sidebar" id="mobileSidebar">
            <a href="/">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
                Trang chủ
            </a>
            <a href="/about/">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
                Về tôi
            </a>
            <a href="/projects/">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/></svg>
                Dự án
            </a>
            <a href="/posts/">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
                Bài viết
            </a>
            <a href="/contact/">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
                Liên hệ
            </a>
        </div>
        
        <div class="mobile-search-overlay" id="mobileSearchOverlay">
            <div class="search-box">
                <button class="search-close" id="searchClose">×</button>
                <input type="text" placeholder="Tìm kiếm bài viết..." id="searchInput">
            </div>
        </div>
        
        <div class="mobile-overlay" id="mobileOverlay"></div>
    `;
    
    document.body.insertAdjacentHTML('afterbegin', menuHTML);
    
    
    const navBtn = document.getElementById('mobileNavBtn');
    const searchBtn = document.getElementById('mobileSearchBtn');
    const sidebar = document.getElementById('mobileSidebar');
    const searchOverlay = document.getElementById('mobileSearchOverlay');
    const overlay = document.getElementById('mobileOverlay');
    const searchClose = document.getElementById('searchClose');
    
    
    function toggleMenu() {
        navBtn.classList.toggle('active');
        sidebar.classList.toggle('active');
        overlay.classList.toggle('active');
        document.body.style.overflow = sidebar.classList.contains('active') ? 'hidden' : '';
    }
    
    
    function toggleSearch() {
        searchOverlay.classList.toggle('active');
        document.body.style.overflow = searchOverlay.classList.contains('active') ? 'hidden' : '';
    }
    
    
    navBtn.addEventListener('click', toggleMenu);
    searchBtn.addEventListener('click', toggleSearch);
    overlay.addEventListener('click', toggleMenu);
    searchClose.addEventListener('click', toggleSearch);
    
    
    sidebar.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', toggleMenu);
    });
});
</script>

  
</head>
<body
    class="m-auto flex h-screen max-w-7xl flex-col bg-neutral px-6 text-lg leading-7 text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"
  >
    <div id="the-top" class="absolute flex self-center">
      <a
        class="-translate-y-8 rounded-b-lg bg-primary-200 px-3 py-1 text-sm focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content"
        ><span class="pe-2 font-bold text-primary-600 dark:text-primary-400">&darr;</span
        >Skip to main content</a
      >
    </div>
    
    
      <header class="py-6 font-semibold text-neutral-900 dark:text-neutral sm:py-10 print:hidden">
  <nav class="flex items-start justify-between sm:items-center">
    
    <div class="flex flex-row items-center">
      
  <a
    class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
    rel="me"
    href="/"
    >Blog của Triệu Xuân Dũng</a
  >

    </div>
    
    
      <ul class="flex list-none flex-col text-end sm:flex-row">
        
          
            
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href="/"
                  title="Trang chủ"
                  
                  ><span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >Trang chủ</span
                    >
                  </a
                >
              
            </li>
          
            
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href="/about/"
                  title="Về tôi"
                  
                  ><span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >Về tôi</span
                    >
                  </a
                >
              
            </li>
          
            
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href="/projects/"
                  title="Dự án của tôi"
                  
                  ><span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >Dự án</span
                    >
                  </a
                >
              
            </li>
          
            
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href="/posts/"
                  title="Posts"
                  
                  ><span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >Bài viết</span
                    >
                  </a
                >
              
            </li>
          
            
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href="/contact/"
                  title="Liên hệ"
                  
                  ><span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >Liên hệ</span
                    >
                  </a
                >
              
            </li>
          
          
        
      </ul>
    
  </nav>
</header>

    
    <div class="relative flex grow flex-col">
      <main id="main-content" class="grow">
        
  <article>
    <header class="max-w-prose">
      
      <h1 class="mb-8 mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        JavaScript Closures: Từ 'Hả?' đến 'À ra thế!' - Bí mật về phạm vi biến
      </h1>
      
        <div class="mb-10 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
          





  
  



  

  
  
    
  

  

  

  
    
  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2025-10-14 00:00:00 &#43;0000 UTC">14 October 2025</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">13 mins</span>
    

    
    
  </div>

  
  
    <div class="my-1 flex flex-wrap text-xs leading-relaxed text-neutral-500 dark:text-neutral-400">
      
        
          
            <a
              href="http://localhost:1313/categories/javascript/"
              class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400"
              >JavaScript</a
            >
          
            <a
              href="http://localhost:1313/categories/c%C6%A1-b%E1%BA%A3n/"
              class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400"
              >Cơ Bản</a
            >
          
        
      
        
          
            <a
              href="http://localhost:1313/tags/javascript/"
              class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400"
              >JavaScript</a
            >
          
            <a
              href="http://localhost:1313/tags/closures/"
              class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400"
              >Closures</a
            >
          
            <a
              href="http://localhost:1313/tags/scope/"
              class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400"
              >Scope</a
            >
          
            <a
              href="http://localhost:1313/tags/n%C3%A2ng-cao/"
              class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400"
              >Nâng Cao</a
            >
          
            <a
              href="http://localhost:1313/tags/c%C6%A1-b%E1%BA%A3n/"
              class="mx-1 my-1 rounded-md border border-neutral-200 px-1 py-[1px] hover:border-primary-300 hover:text-primary-700 dark:border-neutral-600 dark:hover:border-primary-600 dark:hover:text-primary-400"
              >Cơ Bản</a
            >
          
        
      
    </div>
  


        </div>
      
      
    </header>
    <section class="prose mt-0 flex max-w-full flex-col dark:prose-invert lg:flex-row">
      
        <div class="order-first px-0 lg:order-last lg:max-w-xs lg:ps-8">
          <div class="toc pe-5 lg:sticky lg:top-10 print:hidden">
            <details open class="-ms-5 mt-0 overflow-hidden rounded-lg ps-5">
  <summary
    class="block cursor-pointer bg-neutral-100 py-1 ps-5 text-lg font-semibold text-neutral-800 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden"
  >
    Table of Contents
  </summary>
  <div class="border-s border-dotted border-neutral-300 py-2 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#-trước-khi-hiểu-closure-phạm-vi-scope">🎯 Trước khi hiểu Closure: Phạm Vi (Scope)</a>
      <ul>
        <li><a href="#phạm-vi-là-gì"><strong>Phạm vi là gì?</strong></a></li>
        <li><a href="#var-vs-let-vs-const---khác-nhau-về-phạm-vi"><strong>var vs let vs const - Khác nhau về phạm vi</strong></a></li>
      </ul>
    </li>
    <li><a href="#-closure-định-nghĩa">💡 Closure: Định nghĩa</a>
      <ul>
        <li><a href="#định-nghĩa-kỹ-thuật"><strong>Định nghĩa kỹ thuật:</strong></a></li>
        <li><a href="#ví-dụ-đầu-tiên"><strong>Ví dụ đầu tiên:</strong></a></li>
      </ul>
    </li>
    <li><a href="#-closure-trong-thực-tế">🔍 Closure Trong Thực Tế</a>
      <ul>
        <li><a href="#ví-dụ-1-bộ-đếm-kinh-điển"><strong>Ví dụ 1: Bộ đếm (Kinh điển)</strong></a></li>
        <li><a href="#ví-dụ-2-xử-lý-sự-kiện"><strong>Ví dụ 2: Xử lý sự kiện</strong></a></li>
        <li><a href="#ví-dụ-3-nhà-máy-sản-xuất-hàm"><strong>Ví dụ 3: Nhà máy sản xuất hàm</strong></a></li>
      </ul>
    </li>
    <li><a href="#-mẫu-thiết-kế-nâng-cao-với-closure">🎯 Mẫu thiết kế nâng cao với Closure</a>
      <ul>
        <li><a href="#mẫu-1-module-đóng-gói"><strong>Mẫu 1: Module (Đóng gói)</strong></a></li>
        <li><a href="#mẫu-2-ghi-nhớ-caching"><strong>Mẫu 2: Ghi nhớ (Caching)</strong></a></li>
        <li><a href="#mẫu-3-currying-gọi-từng-phần"><strong>Mẫu 3: Currying (Gọi từng phần)</strong></a></li>
      </ul>
    </li>
    <li><a href="#-cạm-bẫy-closure--giải-pháp">⚠️ Cạm bẫy Closure &amp; Giải pháp</a>
      <ul>
        <li><a href="#cạm-bẫy-1-rò-rỉ-bộ-nhớ"><strong>Cạm bẫy 1: Rò rỉ bộ nhớ</strong></a></li>
        <li><a href="#cạm-bẫy-2-vòng-lặp--bất-đồng-bộ"><strong>Cạm bẫy 2: Vòng lặp + Bất đồng bộ</strong></a></li>
        <li><a href="#cạm-bẫy-3-biến-toàn-cục-vô-tình"><strong>Cạm bẫy 3: Biến toàn cục vô tình</strong></a></li>
      </ul>
    </li>
    <li><a href="#-dự-án-thực-tế-giỏ-hàng-với-closure">🏗️ Dự án thực tế: Giỏ hàng với Closure</a></li>
    <li><a href="#-khi-nào-dùng-closure">💡 Khi nào dùng Closure?</a>
      <ul>
        <li><a href="#nên-dùng-closure-cho"><strong>Nên dùng Closure cho:</strong></a></li>
        <li><a href="#đừng-lạm-dụng"><strong>ĐỪNG lạm dụng:</strong></a></li>
      </ul>
    </li>
    <li><a href="#-hành-trình-hiểu-closure">📊 Hành trình hiểu Closure</a>
      <ul>
        <li><a href="#giai-đoạn-1--tuần-1"><strong>Giai đoạn 1: “Closure là gì?”</strong> (Tuần 1)</a></li>
        <li><a href="#giai-đoạn-2--tuần-2-3"><strong>Giai đoạn 2: “À, cú pháp như thế”</strong> (Tuần 2-3)</a></li>
        <li><a href="#giai-đoạn-3--tuần-4-6"><strong>Giai đoạn 3: “Khoan, tại sao vậy?”</strong> (Tuần 4-6)</a></li>
        <li><a href="#giai-đoạn-4--tuần-7-8"><strong>Giai đoạn 4: “Mạnh quá!”</strong> (Tuần 7-8)</a></li>
        <li><a href="#giai-đoạn-5--tuần-9"><strong>Giai đoạn 5: “Không thể thiếu”</strong> (Tuần 9+)</a></li>
      </ul>
    </li>
    <li><a href="#-tài-nguyên-học-tập">📚 Tài nguyên học tập</a></li>
    <li><a href="#-kết-luận">💭 Kết luận</a></li>
  </ul>
</nav>
  </div>
</details>

          </div>
        </div>
      
      <div class="min-h-0 min-w-0 max-w-prose grow">
        <p>Tháng thứ 6 học JavaScript, tôi tự tin là đã &ldquo;biết&rdquo; ngôn ngữ này. Biến, hàm, đối tượng, mảng - dễ ợt.</p>
<p>Cho đến khi tôi gặp đoạn code này trong buổi phỏng vấn:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Người phỏng vấn: &#34;Kết quả là gì?&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1">// Tôi: &#34;0, 1, 2 chứ còn gì!&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1">// Thực tế: 3, 3, 3
</span></span></span></code></pre></div><p><em>&ldquo;Hả? Sao lại thế?&rdquo;</em></p>
<p>Người phỏng vấn mỉm cười: <em>&ldquo;Bạn có biết closure không?&rdquo;</em></p>
<p><em>&ldquo;Clo&hellip; gì cơ?&rdquo;</em></p>
<p>Trượt phỏng vấn. Nhưng tò mò. Closure là gì mà quan trọng thế?</p>
<p>3 tháng nghiên cứu, thực hành, và vô số lần &ldquo;à ra thế!&rdquo; sau, tôi cuối cùng cũng hiểu. Và nhận ra: <strong>Closure là một trong những tính năng quan trọng nhất của JavaScript.</strong></p>
<p>






  
  
<figure><img src="https://images.unsplash.com/photo-1555952494-efd681c7e3f9?w=1200&amp;h=600&amp;fit=crop" alt="JavaScript Closures - Bối rối" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<p>Đây là lộ trình để bạn hiểu closure - không cần mất 3 tháng như tôi.</p>
<hr>
<h2 id="-trước-khi-hiểu-closure-phạm-vi-scope" class="relative group">🎯 Trước khi hiểu Closure: Phạm Vi (Scope) <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#-tr%c6%b0%e1%bb%9bc-khi-hi%e1%bb%83u-closure-ph%e1%ba%a1m-vi-scope" aria-label="Anchor">#</a></span></h2><h3 id="phạm-vi-là-gì" class="relative group"><strong>Phạm vi là gì?</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#ph%e1%ba%a1m-vi-l%c3%a0-g%c3%ac" aria-label="Anchor">#</a></span></h3><p>Phạm vi = Nơi một biến có thể được truy cập.</p>
<p>Hãy tưởng tượng như tầng nhà:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// Tầng trệt (toàn cục)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">bienToanCuc</span> <span class="o">=</span> <span class="s2">&#34;Tôi ở tầng trệt&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">hamNgoai</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Tầng 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">const</span> <span class="nx">bienTang1</span> <span class="o">=</span> <span class="s2">&#34;Tôi ở tầng 1&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kd">function</span> <span class="nx">hamTrong</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Tầng 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kr">const</span> <span class="nx">bienTang2</span> <span class="o">=</span> <span class="s2">&#34;Tôi ở tầng 2&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bienToanCuc</span><span class="p">);</span>  <span class="c1">// ✅ Nhìn xuống tầng trệt được
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bienTang1</span><span class="p">);</span>    <span class="c1">// ✅ Nhìn xuống tầng 1 được
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bienTang2</span><span class="p">);</span>    <span class="c1">// ✅ Trong phòng mình
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bienToanCuc</span><span class="p">);</span>  <span class="c1">// ✅ Nhìn xuống được
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bienTang1</span><span class="p">);</span>    <span class="c1">// ✅ Trong phòng mình
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bienTang2</span><span class="p">);</span>    <span class="c1">// ❌ Không nhìn lên trên được!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bienToanCuc</span><span class="p">);</span>  <span class="c1">// ✅ Trong phòng mình
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bienTang1</span><span class="p">);</span>    <span class="c1">// ❌ Không lên được tầng 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bienTang2</span><span class="p">);</span>    <span class="c1">// ❌ Không lên được tầng 2
</span></span></span></code></pre></div><p><strong>Quy tắc vàng:</strong> Bên trong có thể &ldquo;nhìn ra ngoài&rdquo;, nhưng bên ngoài không &ldquo;nhìn vào trong&rdquo;.</p>
<p>






  
  
<figure><img src="https://images.unsplash.com/photo-1509228468518-180dd4864904?w=1200&amp;h=600&amp;fit=crop" alt="Chuỗi phạm vi JavaScript" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<p><em>Sơ đồ: Chuỗi phạm vi - hàm bên trong có thể truy cập biến bên ngoài</em></p>
<h3 id="var-vs-let-vs-const---khác-nhau-về-phạm-vi" class="relative group"><strong>var vs let vs const - Khác nhau về phạm vi</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#var-vs-let-vs-const---kh%c3%a1c-nhau-v%e1%bb%81-ph%e1%ba%a1m-vi" aria-label="Anchor">#</a></span></h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// var - Phạm vi hàm
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">kiemTraVar</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span> <span class="c1">// ✅ 10 - var &#34;thoát ra&#34; khỏi khối if
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// let/const - Phạm vi khối {}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">kiemTraLet</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">let</span> <span class="nx">y</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">z</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">y</span><span class="p">);</span> <span class="c1">// ❌ Lỗi: y không tồn tại
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">z</span><span class="p">);</span> <span class="c1">// ❌ Lỗi: z không tồn tại
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Vấn đề kinh điển của var
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// var i có phạm vi cả hàm, không chỉ trong vòng lặp!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span> <span class="c1">// 3 - i &#34;rò rỉ&#34; ra ngoài!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// let giải quyết vấn đề này
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// let j chỉ tồn tại trong vòng lặp
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">j</span><span class="p">);</span> <span class="c1">// ❌ Lỗi - tốt!
</span></span></span></code></pre></div><p><strong>Bài học:</strong> Luôn dùng <code>let</code>/<code>const</code>, không bao giờ dùng <code>var</code>.</p>
<hr>
<h2 id="-closure-định-nghĩa" class="relative group">💡 Closure: Định nghĩa <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#-closure-%c4%91%e1%bb%8bnh-ngh%c4%a9a" aria-label="Anchor">#</a></span></h2><h3 id="định-nghĩa-kỹ-thuật" class="relative group"><strong>Định nghĩa kỹ thuật:</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%c4%91%e1%bb%8bnh-ngh%c4%a9a-k%e1%bb%b9-thu%e1%ba%adt" aria-label="Anchor">#</a></span></h3><blockquote>
<p>&ldquo;Closure là một hàm có thể truy cập biến ở phạm vi bên ngoài (bao quanh nó), ngay cả khi hàm bên ngoài đã kết thúc.&rdquo;</p></blockquote>
<p><strong>Nói người thường hiểu:</strong></p>
<blockquote>
<p>&ldquo;Một hàm &rsquo;nhớ&rsquo; môi trường nơi nó được sinh ra, kể cả khi môi trường đó không còn tồn tại nữa.&rdquo;</p></blockquote>
<p><strong>Giống như:</strong> Con mang gen của cha mẹ, dù cha mẹ không còn ở bên.</p>
<h3 id="ví-dụ-đầu-tiên" class="relative group"><strong>Ví dụ đầu tiên:</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#v%c3%ad-d%e1%bb%a5-%c4%91%e1%ba%a7u-ti%c3%aan" aria-label="Anchor">#</a></span></h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">taoLoiChao</span><span class="p">(</span><span class="nx">loiChao</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// loiChao = biến bên ngoài
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">ten</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Hàm này &#34;nhớ&#34; loiChao
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`</span><span class="si">${</span><span class="nx">loiChao</span><span class="si">}</span><span class="sb">, </span><span class="si">${</span><span class="nx">ten</span><span class="si">}</span><span class="sb">!`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">chaoHello</span> <span class="o">=</span> <span class="nx">taoLoiChao</span><span class="p">(</span><span class="s2">&#34;Hello&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">chaoXinChao</span> <span class="o">=</span> <span class="nx">taoLoiChao</span><span class="p">(</span><span class="s2">&#34;Xin chào&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">chaoHello</span><span class="p">(</span><span class="s2">&#34;Minh&#34;</span><span class="p">);</span>      <span class="c1">// &#34;Hello, Minh!&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">chaoXinChao</span><span class="p">(</span><span class="s2">&#34;Hương&#34;</span><span class="p">);</span>   <span class="c1">// &#34;Xin chào, Hương!&#34;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// Hàm taoLoiChao đã chạy xong, nhưng loiChao vẫn còn!
</span></span></span></code></pre></div><p><strong>Chuyện gì đã xảy ra?</strong></p>
<ol>
<li><code>taoLoiChao(&quot;Hello&quot;)</code> chạy</li>
<li>Tạo hàm bên trong nhớ <code>loiChao</code></li>
<li>Trả về hàm đó</li>
<li><code>taoLoiChao</code> kết thúc, bình thường <code>loiChao</code> nên &ldquo;chết&rdquo;</li>
<li><strong>Nhưng không!</strong> Hàm bên trong đã &ldquo;đóng gói&rdquo; <code>loiChao</code> lại</li>
<li>Sau đó, <code>chaoHello(&quot;Minh&quot;)</code> vẫn dùng được <code>loiChao = &quot;Hello&quot;</code></li>
</ol>
<p><strong>Đây chính là closure!</strong></p>
<p>






  
  
<figure><img src="https://images.unsplash.com/photo-1607799279861-4dd421887fb3?w=1200&amp;h=600&amp;fit=crop" alt="Sơ đồ Closure" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<p><em>Minh họa: Hàm &ldquo;mang theo&rdquo; môi trường của nó</em></p>
<hr>
<h2 id="-closure-trong-thực-tế" class="relative group">🔍 Closure Trong Thực Tế <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#-closure-trong-th%e1%bb%b1c-t%e1%ba%bf" aria-label="Anchor">#</a></span></h2><h3 id="ví-dụ-1-bộ-đếm-kinh-điển" class="relative group"><strong>Ví dụ 1: Bộ đếm (Kinh điển)</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#v%c3%ad-d%e1%bb%a5-1-b%e1%bb%99-%c4%91%e1%ba%bfm-kinh-%c4%91i%e1%bb%83n" aria-label="Anchor">#</a></span></h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// ❌ Tệ: Biến toàn cục
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">let</span> <span class="nx">bodem</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">tang</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">bodem</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">bodem</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Vấn đề: Ai cũng có thể sửa bodem
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">bodem</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="c1">// Oái!
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// ✅ Tốt: Closure bảo vệ biến riêng tư
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">taoBoDem</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">dem</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// Biến riêng tư
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">tang</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">dem</span><span class="o">++</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">dem</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">giam</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">dem</span><span class="o">--</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">dem</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">layGiaTri</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">dem</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">bodem</span> <span class="o">=</span> <span class="nx">taoBoDem</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bodem</span><span class="p">.</span><span class="nx">tang</span><span class="p">());</span>     <span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bodem</span><span class="p">.</span><span class="nx">tang</span><span class="p">());</span>     <span class="c1">// 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bodem</span><span class="p">.</span><span class="nx">giam</span><span class="p">());</span>     <span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bodem</span><span class="p">.</span><span class="nx">layGiaTri</span><span class="p">());</span><span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// dem thực sự là riêng tư
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bodem</span><span class="p">.</span><span class="nx">dem</span><span class="p">);</span>  <span class="c1">// undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">bodem</span><span class="p">.</span><span class="nx">dem</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>         <span class="c1">// Không ảnh hưởng gì
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bodem</span><span class="p">.</span><span class="nx">layGiaTri</span><span class="p">());</span> <span class="c1">// Vẫn là 1!
</span></span></span></code></pre></div><p><strong>Lợi ích:</strong></p>
<ul>
<li>✅ Đóng gói dữ liệu</li>
<li>✅ Biến riêng tư</li>
<li>✅ Kiểm soát truy cập</li>
</ul>
<p>






  
  
<figure><img src="https://images.unsplash.com/photo-1434626881859-194d67b2b86f?w=1200&amp;h=600&amp;fit=crop" alt="Bộ đếm Closure" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<h3 id="ví-dụ-2-xử-lý-sự-kiện" class="relative group"><strong>Ví dụ 2: Xử lý sự kiện</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#v%c3%ad-d%e1%bb%a5-2-x%e1%bb%ad-l%c3%bd-s%e1%bb%b1-ki%e1%bb%87n" aria-label="Anchor">#</a></span></h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// ❌ Vấn đề: Tất cả nút bấm hiện cùng giá trị
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">cauHinhNutBam</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">cacNutBam</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">cacNutBam</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">cacNutBam</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Nút &#39;</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="s1">&#39; được bấm&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Luôn hiện &#34;Nút 3 được bấm&#34;! (nếu có 3 nút)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Tại sao? var i có phạm vi hàm, tất cả handler dùng chung i
</span></span></span><span class="line"><span class="cl"><span class="c1">// Khi click, vòng lặp đã xong, i = 3
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// ✅ Giải pháp 1: Dùng let (phạm vi khối)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">cauHinhNutBam</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">cacNutBam</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">cacNutBam</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Mỗi lần lặp tạo i mới trong phạm vi riêng
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">cacNutBam</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Nút &#39;</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="s1">&#39; được bấm&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Đúng: Nút 0, Nút 1, Nút 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ✅ Giải pháp 2: Hàm ngay lập tức (IIFE)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">cauHinhNutBam</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">cacNutBam</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">cacNutBam</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">chiSo</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Tạo closure với chiSo
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="nx">cacNutBam</span><span class="p">[</span><span class="nx">chiSo</span><span class="p">].</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Nút &#39;</span> <span class="o">+</span> <span class="nx">chiSo</span> <span class="o">+</span> <span class="s1">&#39; được bấm&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">});</span>
</span></span><span class="line"><span class="cl">        <span class="p">})(</span><span class="nx">i</span><span class="p">);</span> <span class="c1">// Truyền i làm tham số
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>Câu hỏi phỏng vấn đã giải quyết!</strong> ✅</p>
<h3 id="ví-dụ-3-nhà-máy-sản-xuất-hàm" class="relative group"><strong>Ví dụ 3: Nhà máy sản xuất hàm</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#v%c3%ad-d%e1%bb%a5-3-nh%c3%a0-m%c3%a1y-s%e1%ba%a3n-xu%e1%ba%a5t-h%c3%a0m" aria-label="Anchor">#</a></span></h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">taoBoNhan</span><span class="p">(</span><span class="nx">soNhan</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">so</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">so</span> <span class="o">*</span> <span class="nx">soNhan</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">nhanDoi</span> <span class="o">=</span> <span class="nx">taoBoNhan</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">nhanBa</span> <span class="o">=</span> <span class="nx">taoBoNhan</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">nhanBon</span> <span class="o">=</span> <span class="nx">taoBoNhan</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">nhanDoi</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span>     <span class="c1">// 10
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">nhanBa</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span>      <span class="c1">// 15
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">nhanBon</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span>     <span class="c1">// 20
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// Mỗi hàm &#34;nhớ&#34; soNhan riêng của nó!
</span></span></span></code></pre></div><p><strong>Ứng dụng thực tế:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// Nhà máy tạo API client
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">taoAPIClient</span><span class="p">(</span><span class="nx">urlGoc</span><span class="p">,</span> <span class="nx">apiKey</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">get</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">duongDan</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="sb">`</span><span class="si">${</span><span class="nx">urlGoc</span><span class="si">}${</span><span class="nx">duongDan</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span> <span class="s1">&#39;Authorization&#39;</span><span class="o">:</span> <span class="sb">`Bearer </span><span class="si">${</span><span class="nx">apiKey</span><span class="si">}</span><span class="sb">`</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="p">});</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">post</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">duongDan</span><span class="p">,</span> <span class="nx">duLieu</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="sb">`</span><span class="si">${</span><span class="nx">urlGoc</span><span class="si">}${</span><span class="nx">duongDan</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;POST&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="nx">headers</span><span class="o">:</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;Authorization&#39;</span><span class="o">:</span> <span class="sb">`Bearer </span><span class="si">${</span><span class="nx">apiKey</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s1">&#39;Content-Type&#39;</span><span class="o">:</span> <span class="s1">&#39;application/json&#39;</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="nx">body</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">duLieu</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">});</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Tạo các client khác nhau
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">githubAPI</span> <span class="o">=</span> <span class="nx">taoAPIClient</span><span class="p">(</span><span class="s1">&#39;https://api.github.com&#39;</span><span class="p">,</span> <span class="s1">&#39;github_token&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">stripeAPI</span> <span class="o">=</span> <span class="nx">taoAPIClient</span><span class="p">(</span><span class="s1">&#39;https://api.stripe.com&#39;</span><span class="p">,</span> <span class="s1">&#39;stripe_token&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Mỗi cái nhớ urlGoc và apiKey riêng
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">githubAPI</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/user/repos&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="nx">stripeAPI</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="s1">&#39;/charges&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="nx">amount</span><span class="o">:</span> <span class="mi">1000</span> <span class="p">});</span>
</span></span></code></pre></div><p>






  
  
<figure><img src="https://images.unsplash.com/photo-1581291518633-83b4ebd1d83e?w=1200&amp;h=600&amp;fit=crop" alt="Nhà máy hàm" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<hr>
<h2 id="-mẫu-thiết-kế-nâng-cao-với-closure" class="relative group">🎯 Mẫu thiết kế nâng cao với Closure <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#-m%e1%ba%abu-thi%e1%ba%bft-k%e1%ba%bf-n%c3%a2ng-cao-v%e1%bb%9bi-closure" aria-label="Anchor">#</a></span></h2><h3 id="mẫu-1-module-đóng-gói" class="relative group"><strong>Mẫu 1: Module (Đóng gói)</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#m%e1%ba%abu-1-module-%c4%91%c3%b3ng-g%c3%b3i" aria-label="Anchor">#</a></span></h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">MayTinh</span> <span class="o">=</span> <span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Biến và hàm riêng tư
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">let</span> <span class="nx">ketQua</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kd">function</span> <span class="nx">ghiNhatKy</span><span class="p">(</span><span class="nx">thongBao</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`[Máy tính] </span><span class="si">${</span><span class="nx">thongBao</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// API công khai
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">cong</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">ketQua</span> <span class="o">+=</span> <span class="nx">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">ghiNhatKy</span><span class="p">(</span><span class="sb">`Cộng </span><span class="si">${</span><span class="nx">x</span><span class="si">}</span><span class="sb">, kết quả: </span><span class="si">${</span><span class="nx">ketQua</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span><span class="p">;</span> <span class="c1">// Cho phép gọi chuỗi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">tru</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">ketQua</span> <span class="o">-=</span> <span class="nx">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">ghiNhatKy</span><span class="p">(</span><span class="sb">`Trừ </span><span class="si">${</span><span class="nx">x</span><span class="si">}</span><span class="sb">, kết quả: </span><span class="si">${</span><span class="nx">ketQua</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">nhan</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">ketQua</span> <span class="o">*=</span> <span class="nx">x</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">ghiNhatKy</span><span class="p">(</span><span class="sb">`Nhân </span><span class="si">${</span><span class="nx">x</span><span class="si">}</span><span class="sb">, kết quả: </span><span class="si">${</span><span class="nx">ketQua</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">layKetQua</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">ketQua</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">datLai</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">ketQua</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="nx">ghiNhatKy</span><span class="p">(</span><span class="s1">&#39;Đặt lại&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">})();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Sử dụng
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">MayTinh</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">cong</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">nhan</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">tru</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">layKetQua</span><span class="p">();</span> <span class="c1">// 7
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// Không thể truy cập các thành phần riêng tư
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">MayTinh</span><span class="p">.</span><span class="nx">ketQua</span><span class="p">;</span>  <span class="c1">// undefined
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">MayTinh</span><span class="p">.</span><span class="nx">ghiNhatKy</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">);</span> <span class="c1">// Lỗi
</span></span></span></code></pre></div><p><strong>Lợi ích:</strong></p>
<ul>
<li>✅ Đóng gói</li>
<li>✅ Tách biệt public/private</li>
<li>✅ Tránh làm ô nhiễm namespace</li>
</ul>
<h3 id="mẫu-2-ghi-nhớ-caching" class="relative group"><strong>Mẫu 2: Ghi nhớ (Caching)</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#m%e1%ba%abu-2-ghi-nh%e1%bb%9b-caching" aria-label="Anchor">#</a></span></h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">ghiNho</span><span class="p">(</span><span class="nx">ham</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">boNho</span> <span class="o">=</span> <span class="p">{};</span> <span class="c1">// Bộ nhớ cache riêng tư qua closure
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kd">function</span><span class="p">(...</span><span class="nx">thamSo</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">khoa</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">thamSo</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">khoa</span> <span class="k">in</span> <span class="nx">boNho</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Lấy từ bộ nhớ&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">boNho</span><span class="p">[</span><span class="nx">khoa</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Tính toán kết quả&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">ketQua</span> <span class="o">=</span> <span class="nx">ham</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">thamSo</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="nx">boNho</span><span class="p">[</span><span class="nx">khoa</span><span class="p">]</span> <span class="o">=</span> <span class="nx">ketQua</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">ketQua</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Hàm tốn kém
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">fibonacci</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">n</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span> <span class="k">return</span> <span class="nx">n</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">fibonacci</span><span class="p">(</span><span class="nx">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="nx">fibonacci</span><span class="p">(</span><span class="nx">n</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">fibGhiNho</span> <span class="o">=</span> <span class="nx">ghiNho</span><span class="p">(</span><span class="nx">fibonacci</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fibGhiNho</span><span class="p">(</span><span class="mi">40</span><span class="p">));</span> <span class="c1">// Tính toán... 102334155 (chậm)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">fibGhiNho</span><span class="p">(</span><span class="mi">40</span><span class="p">));</span> <span class="c1">// Lấy từ bộ nhớ: 102334155 (tức thì!)
</span></span></span></code></pre></div><p><strong>Tăng hiệu suất:</strong> Nhanh hơn 1000 lần cho các lần gọi lặp lại!</p>
<h3 id="mẫu-3-currying-gọi-từng-phần" class="relative group"><strong>Mẫu 3: Currying (Gọi từng phần)</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#m%e1%ba%abu-3-currying-g%e1%bb%8di-t%e1%bb%abng-ph%e1%ba%a7n" aria-label="Anchor">#</a></span></h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// Hàm thông thường
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">cong</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span> <span class="o">+</span> <span class="nx">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">cong</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span> <span class="c1">// 6
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// Phiên bản curry
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">congCurry</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span> <span class="o">+</span> <span class="nx">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">congCurry</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="mi">2</span><span class="p">)(</span><span class="mi">3</span><span class="p">);</span> <span class="c1">// 6
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// Hoặc với arrow function
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">congCurry</span> <span class="o">=</span> <span class="nx">a</span> <span class="p">=&gt;</span> <span class="nx">b</span> <span class="p">=&gt;</span> <span class="nx">c</span> <span class="p">=&gt;</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span> <span class="o">+</span> <span class="nx">c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Áp dụng từng phần
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">cong5</span> <span class="o">=</span> <span class="nx">congCurry</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">cong5Va10</span> <span class="o">=</span> <span class="nx">cong5</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">cong5Va10</span><span class="p">(</span><span class="mi">3</span><span class="p">));</span> <span class="c1">// 18
</span></span></span></code></pre></div><p><strong>Ví dụ thực tế:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// Tạo xử lý sự kiện tổng quát
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">taoXuLySuKien</span> <span class="o">=</span> <span class="nx">loaiSuKien</span> <span class="p">=&gt;</span> <span class="nx">phanTu</span> <span class="p">=&gt;</span> <span class="nx">callback</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">phanTu</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="nx">loaiSuKien</span><span class="p">,</span> <span class="nx">callback</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">khiClick</span> <span class="o">=</span> <span class="nx">taoXuLySuKien</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">khiDiChuot</span> <span class="o">=</span> <span class="nx">taoXuLySuKien</span><span class="p">(</span><span class="s1">&#39;mouseenter&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Xử lý có thể tái sử dụng
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">clickNutBam</span> <span class="o">=</span> <span class="nx">khiClick</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">diChuotVaoDiv</span> <span class="o">=</span> <span class="nx">khiDiChuot</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">clickNutBam</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Nút được bấm&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="nx">diChuotVaoDiv</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Chuột vào div&#39;</span><span class="p">));</span>
</span></span></code></pre></div><p>






  
  
<figure><img src="https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=1200&amp;h=600&amp;fit=crop" alt="Mẫu Currying" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<hr>
<h2 id="-cạm-bẫy-closure--giải-pháp" class="relative group">⚠️ Cạm bẫy Closure &amp; Giải pháp <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#-c%e1%ba%a1m-b%e1%ba%aby-closure--gi%e1%ba%a3i-ph%c3%a1p" aria-label="Anchor">#</a></span></h2><h3 id="cạm-bẫy-1-rò-rỉ-bộ-nhớ" class="relative group"><strong>Cạm bẫy 1: Rò rỉ bộ nhớ</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#c%e1%ba%a1m-b%e1%ba%aby-1-r%c3%b2-r%e1%bb%89-b%e1%bb%99-nh%e1%bb%9b" aria-label="Anchor">#</a></span></h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// ❌ Rò rỉ bộ nhớ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">phepToanNang</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">duLieuLon</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">1000000</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="s1">&#39;dữ liệu&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Closure giữ tham chiếu đến duLieuLon
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">duLieuLon</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">ham</span> <span class="o">=</span> <span class="nx">phepToanNang</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="c1">// duLieuLon vẫn trong bộ nhớ dù không dùng!
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// ✅ Giải pháp: Chỉ &#34;đóng gói&#34; những gì cần
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">phepToanNang</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">duLieuLon</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">1000000</span><span class="p">).</span><span class="nx">fill</span><span class="p">(</span><span class="s1">&#39;dữ liệu&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">doDai</span> <span class="o">=</span> <span class="nx">duLieuLon</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="c1">// Chỉ lấy giá trị cần thiết
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// Chỉ đóng gói doDai, không phải toàn bộ duLieuLon
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">doDai</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="cạm-bẫy-2-vòng-lặp--bất-đồng-bộ" class="relative group"><strong>Cạm bẫy 2: Vòng lặp + Bất đồng bộ</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#c%e1%ba%a1m-b%e1%ba%aby-2-v%c3%b2ng-l%e1%ba%b7p--b%e1%ba%a5t-%c4%91%e1%bb%93ng-b%e1%bb%99" aria-label="Anchor">#</a></span></h3><p>Đây là bug kinh điển từ đầu bài:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// ❌ Vấn đề
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span> <span class="c1">// 3, 3, 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ✅ Giải pháp 1: let
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span> <span class="c1">// 0, 1, 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ✅ Giải pháp 2: IIFE
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">chiSo</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">chiSo</span><span class="p">);</span> <span class="c1">// 0, 1, 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="p">},</span> <span class="mi">1000</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">})(</span><span class="nx">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ✅ Giải pháp 3: Truyền vào setTimeout
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">chiSo</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">chiSo</span><span class="p">);</span> <span class="c1">// 0, 1, 2
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="p">},</span> <span class="mi">1000</span><span class="p">,</span> <span class="nx">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="cạm-bẫy-3-biến-toàn-cục-vô-tình" class="relative group"><strong>Cạm bẫy 3: Biến toàn cục vô tình</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#c%e1%ba%a1m-b%e1%ba%aby-3-bi%e1%ba%bfn-to%c3%a0n-c%e1%bb%a5c-v%c3%b4-t%c3%acnh" aria-label="Anchor">#</a></span></h3><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">taoBoDem</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// ❌ Quên &#39;let&#39; - tạo biến toàn cục!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">dem</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="o">++</span><span class="nx">dem</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">bodem1</span> <span class="o">=</span> <span class="nx">taoBoDem</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">bodem2</span> <span class="o">=</span> <span class="nx">taoBoDem</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bodem1</span><span class="p">());</span> <span class="c1">// 1
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">bodem2</span><span class="p">());</span> <span class="c1">// 2 (dùng chung biến toàn cục dem!)
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// ✅ Luôn dùng let/const
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">taoBoDem</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">dem</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// Phạm vi đúng
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="o">++</span><span class="nx">dem</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p><strong>Dùng chế độ nghiêm ngặt để bắt lỗi:</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">taoBoDem</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">dem</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// Lỗi: dem chưa được khai báo
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="o">++</span><span class="nx">dem</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>






  
  
<figure><img src="https://images.unsplash.com/photo-1563986768609-322da13575f3?w=1200&amp;h=600&amp;fit=crop" alt="Cảnh báo rò rỉ bộ nhớ" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<hr>
<h2 id="-dự-án-thực-tế-giỏ-hàng-với-closure" class="relative group">🏗️ Dự án thực tế: Giỏ hàng với Closure <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#-d%e1%bb%b1-%c3%a1n-th%e1%bb%b1c-t%e1%ba%bf-gi%e1%bb%8f-h%c3%a0ng-v%e1%bb%9bi-closure" aria-label="Anchor">#</a></span></h2><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">taoGioHang</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// Trạng thái riêng tư
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">let</span> <span class="nx">cacMonHang</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">tyLeGiamGia</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// Hàm hỗ trợ riêng tư
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">function</span> <span class="nx">tinhTongMonHang</span><span class="p">(</span><span class="nx">monHang</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">monHang</span><span class="p">.</span><span class="nx">gia</span> <span class="o">*</span> <span class="nx">monHang</span><span class="p">.</span><span class="nx">soLuong</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// API công khai
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">themMonHang</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sanPham</span><span class="p">,</span> <span class="nx">soLuong</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kr">const</span> <span class="nx">monHangCoSan</span> <span class="o">=</span> <span class="nx">cacMonHang</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">mh</span> <span class="p">=&gt;</span> <span class="nx">mh</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">sanPham</span><span class="p">.</span><span class="nx">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">monHangCoSan</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">monHangCoSan</span><span class="p">.</span><span class="nx">soLuong</span> <span class="o">+=</span> <span class="nx">soLuong</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">cacMonHang</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">                    <span class="p">...</span><span class="nx">sanPham</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">soLuong</span>
</span></span><span class="line"><span class="cl">                <span class="p">});</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nx">xoaMonHang</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">idSanPham</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">cacMonHang</span> <span class="o">=</span> <span class="nx">cacMonHang</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">mh</span> <span class="p">=&gt;</span> <span class="nx">mh</span><span class="p">.</span><span class="nx">id</span> <span class="o">!==</span> <span class="nx">idSanPham</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nx">capNhatSoLuong</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">idSanPham</span><span class="p">,</span> <span class="nx">soLuong</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kr">const</span> <span class="nx">monHang</span> <span class="o">=</span> <span class="nx">cacMonHang</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">mh</span> <span class="p">=&gt;</span> <span class="nx">mh</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">idSanPham</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="p">(</span><span class="nx">monHang</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">monHang</span><span class="p">.</span><span class="nx">soLuong</span> <span class="o">=</span> <span class="nx">soLuong</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nx">apDungGiamGia</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">tyLe</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">tyLeGiamGia</span> <span class="o">=</span> <span class="nx">tyLe</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nx">tinhTongTien</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kr">const</span> <span class="nx">tongTam</span> <span class="o">=</span> <span class="nx">cacMonHang</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">tong</span><span class="p">,</span> <span class="nx">mh</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="nx">tong</span> <span class="o">+</span> <span class="nx">tinhTongMonHang</span><span class="p">(</span><span class="nx">mh</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">            
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">tongTam</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="nx">tyLeGiamGia</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nx">layDanhSach</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="c1">// Trả về bản sao để tránh sửa đổi từ bên ngoài
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">return</span> <span class="nx">cacMonHang</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">mh</span> <span class="p">=&gt;</span> <span class="p">({</span> <span class="p">...</span><span class="nx">mh</span> <span class="p">}));</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nx">demSoLuong</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="nx">cacMonHang</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">dem</span><span class="p">,</span> <span class="nx">mh</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">dem</span> <span class="o">+</span> <span class="nx">mh</span><span class="p">.</span><span class="nx">soLuong</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="nx">xoaTrang</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">cacMonHang</span> <span class="o">=</span> <span class="p">[];</span>
</span></span><span class="line"><span class="cl">            <span class="nx">tyLeGiamGia</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Sử dụng
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">gioHang</span> <span class="o">=</span> <span class="nx">taoGioHang</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">gioHang</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">themMonHang</span><span class="p">({</span> <span class="nx">id</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">ten</span><span class="o">:</span> <span class="s1">&#39;Laptop&#39;</span><span class="p">,</span> <span class="nx">gia</span><span class="o">:</span> <span class="mi">20000000</span> <span class="p">},</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">themMonHang</span><span class="p">({</span> <span class="nx">id</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">ten</span><span class="o">:</span> <span class="s1">&#39;Chuột&#39;</span><span class="p">,</span> <span class="nx">gia</span><span class="o">:</span> <span class="mi">500000</span> <span class="p">},</span> <span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">apDungGiamGia</span><span class="p">(</span><span class="mf">0.1</span><span class="p">);</span> <span class="c1">// Giảm 10%
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Tổng tiền:&#39;</span><span class="p">,</span> <span class="nx">gioHang</span><span class="p">.</span><span class="nx">tinhTongTien</span><span class="p">());</span> <span class="c1">// 18.900.000đ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;Số lượng:&#39;</span><span class="p">,</span> <span class="nx">gioHang</span><span class="p">.</span><span class="nx">demSoLuong</span><span class="p">());</span> <span class="c1">// 3
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">// Mảng cacMonHang hoàn toàn riêng tư
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">gioHang</span><span class="p">.</span><span class="nx">cacMonHang</span><span class="p">;</span> <span class="c1">// undefined
</span></span></span></code></pre></div><p><strong>Tại sao dùng closure?</strong></p>
<ul>
<li>✅ <code>cacMonHang</code> và <code>tyLeGiamGia</code> hoàn toàn riêng tư</li>
<li>✅ Kiểm soát truy cập qua các phương thức công khai</li>
<li>✅ Không thể làm rối trạng thái nội bộ từ bên ngoài</li>
<li>✅ API sạch đẹp</li>
</ul>
<hr>
<h2 id="-khi-nào-dùng-closure" class="relative group">💡 Khi nào dùng Closure? <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#-khi-n%c3%a0o-d%c3%b9ng-closure" aria-label="Anchor">#</a></span></h2><h3 id="nên-dùng-closure-cho" class="relative group"><strong>Nên dùng Closure cho:</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#n%c3%aan-d%c3%b9ng-closure-cho" aria-label="Anchor">#</a></span></h3><p>✅ <strong>Bảo mật dữ liệu</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">taoNguoiDung</span><span class="p">(</span><span class="nx">ten</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nx">matKhau</span><span class="p">;</span> <span class="c1">// Riêng tư!
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">datMatKhau</span><span class="o">:</span> <span class="p">(</span><span class="nx">mk</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="nx">matKhau</span> <span class="o">=</span> <span class="nx">mk</span><span class="p">;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">kiemTraMatKhau</span><span class="o">:</span> <span class="p">(</span><span class="nx">mk</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="k">return</span> <span class="nx">mk</span> <span class="o">===</span> <span class="nx">matKhau</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>✅ <strong>Nhà máy hàm</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">taoKiemTra</span> <span class="o">=</span> <span class="p">(</span><span class="nx">bieuThuc</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="nx">dauVao</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">bieuThuc</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">dauVao</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">laEmail</span> <span class="o">=</span> <span class="nx">taoKiemTra</span><span class="p">(</span><span class="sr">/^\S+@\S+$/</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">laSoDienThoai</span> <span class="o">=</span> <span class="nx">taoKiemTra</span><span class="p">(</span><span class="sr">/^\d{10}$/</span><span class="p">);</span>
</span></span></code></pre></div><p>✅ <strong>Ghi nhớ/Cache</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">hamGhiNho</span> <span class="o">=</span> <span class="nx">ghiNho</span><span class="p">(</span><span class="nx">hamTonKem</span><span class="p">);</span>
</span></span></code></pre></div><p>✅ <strong>Xử lý sự kiện</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">nutBam</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="nx">taoXuLySuKien</span><span class="p">(</span><span class="nx">duLieuNguoiDung</span><span class="p">));</span>
</span></span></code></pre></div><h3 id="đừng-lạm-dụng" class="relative group"><strong>ĐỪNG lạm dụng:</strong> <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#%c4%91%e1%bb%abng-l%e1%ba%a1m-d%e1%bb%a5ng" aria-label="Anchor">#</a></span></h3><p>❌ Không cần closure cho hàm đơn giản</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// Thừa thãi
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">cong</span> <span class="o">=</span> <span class="p">(</span><span class="nx">a</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">(</span><span class="nx">b</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Chỉ cần thế này
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">cong</span> <span class="o">=</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
</span></span></code></pre></div><p>❌ Cẩn thận với rò rỉ bộ nhớ</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// Đừng đóng gói các đối tượng lớn không cần thiết
</span></span></span></code></pre></div><hr>
<h2 id="-hành-trình-hiểu-closure" class="relative group">📊 Hành trình hiểu Closure <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#-h%c3%a0nh-tr%c3%acnh-hi%e1%bb%83u-closure" aria-label="Anchor">#</a></span></h2><h3 id="giai-đoạn-1--tuần-1" class="relative group"><strong>Giai đoạn 1: &ldquo;Closure là gì?&rdquo;</strong> (Tuần 1) <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#giai-%c4%91o%e1%ba%a1n-1--tu%e1%ba%a7n-1" aria-label="Anchor">#</a></span></h3><p>Bối rối. Ví dụ không hiểu. Tại sao hàm nhớ được?</p>
<h3 id="giai-đoạn-2--tuần-2-3" class="relative group"><strong>Giai đoạn 2: &ldquo;À, cú pháp như thế&rdquo;</strong> (Tuần 2-3) <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#giai-%c4%91o%e1%ba%a1n-2--tu%e1%ba%a7n-2-3" aria-label="Anchor">#</a></span></h3><p>Có thể viết closure đơn giản. Copy-paste mẫu thì được.</p>
<h3 id="giai-đoạn-3--tuần-4-6" class="relative group"><strong>Giai đoạn 3: &ldquo;Khoan, tại sao vậy?&rdquo;</strong> (Tuần 4-6) <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#giai-%c4%91o%e1%ba%a1n-3--tu%e1%ba%a7n-4-6" aria-label="Anchor">#</a></span></h3><p>Hiểu chuỗi phạm vi. Ngữ cảnh thực thi. Môi trường từ vựng. Lý thuyết bắt đầu rõ.</p>
<h3 id="giai-đoạn-4--tuần-7-8" class="relative group"><strong>Giai đoạn 4: &ldquo;Mạnh quá!&rdquo;</strong> (Tuần 7-8) <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#giai-%c4%91o%e1%ba%a1n-4--tu%e1%ba%a7n-7-8" aria-label="Anchor">#</a></span></h3><p>Nhận ra mẫu closure ở khắp nơi. React hooks, xử lý sự kiện, modules.</p>
<h3 id="giai-đoạn-5--tuần-9" class="relative group"><strong>Giai đoạn 5: &ldquo;Không thể thiếu&rdquo;</strong> (Tuần 9+) <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#giai-%c4%91o%e1%ba%a1n-5--tu%e1%ba%a7n-9" aria-label="Anchor">#</a></span></h3><p>Dùng closure một cách tự nhiên. Tạo mẫu riêng. Đánh giá cao sự tinh tế.</p>
<p><strong>Tổng thời gian:</strong> Khoảng 2-3 tháng để thực sự thành thạo.</p>
<hr>
<h2 id="-tài-nguyên-học-tập" class="relative group">📚 Tài nguyên học tập <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#-t%c3%a0i-nguy%c3%aan-h%e1%bb%8dc-t%e1%ba%adp" aria-label="Anchor">#</a></span></h2><p><strong>Học:</strong></p>
<ul>
<li><a href="https://developer.mozilla.org/vi/docs/Web/JavaScript/Closures" target="_blank" rel="noreferrer">MDN: Closures</a></li>
<li><a href="https://javascript.info/closure" target="_blank" rel="noreferrer">JavaScript.info: Closures</a></li>
<li><a href="https://github.com/getify/You-Dont-Know-JS" target="_blank" rel="noreferrer">You Don&rsquo;t Know JS: Phạm vi &amp; Closures</a></li>
</ul>
<p><strong>Thực hành:</strong></p>
<ul>
<li>Xây dựng biến riêng tư</li>
<li>Tạo nhà máy hàm</li>
<li>Làm hàm ghi nhớ</li>
<li>Refactor code với closure</li>
</ul>
<hr>
<h2 id="-kết-luận" class="relative group">💭 Kết luận <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#-k%e1%ba%bft-lu%e1%ba%adn" aria-label="Anchor">#</a></span></h2><p>9 tháng trước: <em>&ldquo;Closure? Chưa nghe bao giờ.&rdquo;</em></p>
<p>6 tháng trước: <em>&ldquo;Closure có tồn tại nhưng&hellip; khó hiểu quá.&rdquo;</em></p>
<p>3 tháng trước: <em>&ldquo;À! Giờ hiểu rồi!&rdquo;</em></p>
<p>Hôm nay: <em>&ldquo;Closure ở khắp nơi. Không thể không thấy nó.&rdquo;</em></p>
<p><strong>Bài học:</strong></p>
<p>Closure không phải là &ldquo;tính năng nâng cao&rdquo;. Đây là <strong>nền tảng</strong> của JavaScript. Nó xảy ra mỗi khi hàm truy cập biến ở phạm vi bên ngoài. Bạn đã dùng nó mà không biết!</p>
<p>React Hooks? Closure.<br>
Xử lý sự kiện? Closure.<br>
Modules? Closure.<br>
Biến riêng tư? Closure.</p>
<p><strong>Insight quan trọng:</strong></p>
<blockquote>
<p>&ldquo;Các hàm JavaScript mang theo phạm vi của chúng. Hàm không chỉ nhớ những gì chúng làm - chúng còn nhớ NƠI chúng sinh ra.&rdquo;</p></blockquote>
<p>Hiểu closure = Hiểu JavaScript sâu sắc.</p>
<p><strong>Từ &lsquo;Hả?&rsquo; đến &lsquo;À ra thế!&rsquo; - Hành trình xứng đáng với mọi bối rối. 🚀</strong></p>
<hr>
<p><strong>Bạn đã hiểu closure chưa? Chia sẻ khoảnh khắc &ldquo;à ra thế!&rdquo; nhé!</strong></p>
<p><strong>#JavaScript #Closures #PhạmViBiến #MôiTrườngTừVựng #NângCao</strong></p>

      </div>
    </section>
    <footer class="max-w-prose pt-8 print:hidden">
      

      

      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="group flex" href="http://localhost:1313/posts/javascript-es6-plus/">
              <span
                class="me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
                ><span class="ltr:inline rtl:hidden">&larr;</span
                ><span class="ltr:hidden rtl:inline">&rarr;</span></span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >JavaScript ES6+: Từ callback hell đến async/await - Cuộc cách mạng ngôn ngữ tôi đã chứng kiến</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2025-10-14 00:00:00 &#43;0000 UTC">14 October 2025</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="group flex text-right" href="http://localhost:1313/posts/hoc-java-tu-zero-kinh-nghiem/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Hành trình 4 tháng từ 'Hello World' đến Spring Boot: Kinh nghiệm học Java của một sinh viên</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2025-10-14 00:00:00 &#43;0000 UTC">14 October 2025</time>
                  
                </span>
              </span>
              <span
                class="ms-2 text-neutral-700 transition-transform group-hover:-translate-x-[-2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
                ><span class="ltr:inline rtl:hidden">&rarr;</span
                ><span class="ltr:hidden rtl:inline">&larr;</span></span
              >
            </a>
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

      </main>
      
<section class="contact-section-global">
    <div class="contact-wrapper-global">
        <h2 class="contact-title-global">Let me know what's on your mind</h2>
        <form class="contact-form-global">
            <div class="form-row-global">
                <div>
                    <label>First name *</label>
                    <input type="text" required>
                </div>
                <div>
                    <label>Last name *</label>
                    <input type="text" required>
                </div>
            </div>
            <div class="form-group-global">
                <label>Email *</label>
                <input type="email" required>
            </div>
            <div class="form-group-global">
                <label>Leave us a message...</label>
                <textarea rows="4"></textarea>
            </div>
            <button type="submit" class="btn-submit-global">Submit</button>
        </form>
    </div>
</section>


<footer class="custom-footer-compact">
    <div class="footer-inner">
        <p class="footer-text">
            © 2025 Triệu Xuân Dũng • 
            Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a>  
            
        </p>
    </div>
    
    
    <button id="scrollToTop" class="scroll-btn" aria-label="Scroll to top">↑</button>
</footer>

<style>
 

.contact-section-global {
    width: 100vw;
    position: relative;
    left: 50%;
    right: 50%;
    margin-left: -50vw;
    margin-right: -50vw;
    background: #FDF6F0;
    padding: 2.5rem 0;
    margin-top: 3rem;
    margin-bottom: 0;
}

.contact-wrapper-global {
    max-width: 600px;
    margin: 0 auto;
    padding: 0 1.5rem;
}

.contact-title-global {
    font-size: 1.75rem;
    font-weight: 700;
    text-align: center;
    margin-bottom: 1.75rem;
    color: #1f2937;
}

.contact-form-global {
    display: flex;
    flex-direction: column;
    gap: 1.25rem;
}

.form-row-global {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.25rem;
}

.form-row-global label,
.form-group-global label {
    display: block;
    font-size: 0.813rem;
    margin-bottom: 0.4rem;
    color: #4b5563;
}

.form-row-global input,
.form-group-global input,
.form-group-global textarea {
    width: 100%;
    padding: 0.625rem 0;
    border: none;
    border-bottom: 1px solid #d1d5db;
    background: transparent;
    font-size: 0.875rem;
    transition: border-color 0.3s ease;
}

.form-row-global input:focus,
.form-group-global input:focus,
.form-group-global textarea:focus {
    outline: none;
    border-bottom-color: #667eea;
}

.form-group-global textarea {
    resize: vertical;
    font-family: inherit;
}

.btn-submit-global {
    display: block;
    margin: 1rem auto 0;
    padding: 0.75rem 2rem;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    font-weight: 600;
    font-size: 0.875rem;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.btn-submit-global:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
}

 

.custom-footer-compact {
    width: 100vw;
    position: relative;
    left: 50%;
    right: 50%;
    margin-left: -50vw;
    margin-right: -50vw;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 1.5rem 0;
    margin-top: 0;
    border-top: 1px solid rgba(255, 255, 255, 0.2);
}

.footer-inner {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 2rem;
    text-align: center;
}

.footer-text {
    font-size: 0.875rem;
    margin: 0;
    opacity: 0.9;
    line-height: 1.5;
}

.footer-text a {
    color: white;
    text-decoration: underline;
    text-underline-offset: 2px;
    transition: opacity 0.3s ease;
}

.footer-text a:hover {
    opacity: 0.7;
}

 
.scroll-btn {
    position: fixed;
    bottom: 1.5rem;
    right: 1.5rem;
    width: 45px;
    height: 45px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    cursor: pointer;
    font-size: 1.25rem;
    font-weight: bold;
    box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    transition: all 0.3s ease;
    opacity: 0;
    visibility: hidden;
    z-index: 999;
}

.scroll-btn.visible {
    opacity: 1;
    visibility: visible;
}

.scroll-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 16px rgba(102, 126, 234, 0.5);
    background: linear-gradient(135deg, #7c82f5 0%, #8654b3 100%);
}

 

@media (max-width: 768px) {
    .contact-section-global {
        padding: 2rem 0;
        margin-top: 2rem;
    }
    
    .contact-wrapper-global {
        padding: 0 1rem;
    }
    
    .contact-title-global {
        font-size: 1.5rem;
    }
    
    .form-row-global {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    
    .custom-footer-compact {
        padding: 1.25rem 0;
    }
    
    .footer-text {
        font-size: 0.75rem;
    }
    
    .scroll-btn {
        bottom: 1rem;
        right: 1rem;
        width: 40px;
        height: 40px;
        font-size: 1.125rem;
    }
}

@media (max-width: 480px) {
    .footer-text {
        font-size: 0.7rem;
    }
}

 

.dark .contact-section-global {
    background: var(--color-neutral-900);
}

.dark .contact-title-global {
    color: var(--color-neutral-100);
}

.dark .form-row-global input,
.dark .form-group-global input,
.dark .form-group-global textarea {
    color: var(--color-neutral-100);
    border-bottom-color: var(--color-neutral-700);
}

.dark .form-row-global label,
.dark .form-group-global label {
    color: var(--color-neutral-400);
}

.dark .custom-footer-compact {
    background: linear-gradient(135deg, #4c51bf 0%, #553c9a 100%);
}

.dark .scroll-btn {
    background: linear-gradient(135deg, #4c51bf 0%, #553c9a 100%);
}

.dark .scroll-btn:hover {
    background: linear-gradient(135deg, #5b61d6 0%, #6b4bb0 100%);
}
</style>

<script>

document.addEventListener('DOMContentLoaded', function() {
    const scrollBtn = document.getElementById('scrollToTop');
    
    if (scrollBtn) {
        window.addEventListener('scroll', function() {
            if (window.pageYOffset > 300) {
                scrollBtn.classList.add('visible');
            } else {
                scrollBtn.classList.remove('visible');
            }
        });
        
        scrollBtn.addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
    }
});
</script>
    </div>
  </body>
</html>
